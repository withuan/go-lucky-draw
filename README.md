# go-lucky-draw

### 3-1 - 3-3
#### 后端接口的需求：
- 1、奖品列表， 2、抽奖， 3、中奖列表
- 抽奖接口需要满足高性能和高并发要求
- 安全抽奖，奖品不能超发，合理均匀发放

#### 后台管理的需求
- 基本数据管理：奖品、优惠券、用户、IP黑名单、中奖记录
- 实时更新奖品信息，更新数据库存，奖品中奖周期等
- 后台定时任务，生成发奖计划，填充奖品池

#### 抽奖业务流程
抽奖->验证登录->用户抽奖锁定->验证用户今日参与次数->验证IP今日最大限制次数->
验证IP今日抽奖次数->验证IP黑名单->验证用户黑名单->获得抽奖编码->匹配奖品->
验证奖品池库存->发奖，更新奖品库存->发放优惠券->中奖记录->返回结果

#### 数据表设计
奖品、优惠券、中奖记录、用户黑名单、IP黑名单、用户今日参与次数

### 3-4 缓存设计
#### 如何设计和利用缓存
- 目标，提高系统性能，减少数据库依赖
- 原则，平横好“系统性能、开发时间、复杂度”
- 方向，数据读多写少，数据量有限，数据分散
#### 使用redis缓存的地方
- 奖品，数量少，更新频率低，最佳的全量缓存对象
- 优惠券，一次性导入，优惠券编码缓存为set类型
- 中奖记录，读写差不多，可以缓存部分统计数据，如：最新中奖记录，最近大奖发放记录等
- 用户黑名单，读多写少，可以按照uid散列
- IP黑名单，类似用户黑名单，可以按照ip散列
- 用户每日参与次数，读写次数差异没有用户黑名单那么明显，缓存后的收益不明显